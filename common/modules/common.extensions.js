!function(e){"use strict";var t=e.module("common.extensions",[]);t.directive("bubbling",["$parse",function(e){return{restrict:"A",compile:function(){return{post:function(t,n,i){function s(n){if("{"==n[0]){var i={};return t.$watch(n,function(t){Object.keys(t).forEach(function(n){i[n]||(i[n]=e(n).assign),i[n](a,t[n])})},!0),!0}return!1}function r(n){if("["==n[0]){var i=[];n.substring(1,n.length-1).split(",").forEach(function(t){i.push(e(t).assign)}),t.$watchCollection(n,function(e){for(var t=0;t<e.length;t++)i[t](a,e[t])})}}function c(e){return-1!=e.indexOf(",")?(e.split(",").forEach(function(e){o(e)||l(e)}),!0):!1}function o(n){var i=n.match(/^(.+)\sas\s(.+)$/i);if(i){var s=e(i[2]).assign;return t.$watch(i[1],function(e){s(a,e)}),!0}return!1}function l(n){var i=e(n).assign;t.$watch(n,function(e){i(a,e)})}var a=t.$parent;if(!a){var u=n.parent();for(a=u.data("$scope");!a||a===t;){if(u=u.parent(),!u||!u.length)return;a=u.data("$scope")}}var f=String(i.bubbling).trim();s(f)||r(f)||c(f)||o(f)||l(f)}}}}}]),t.directive("injectService",["$injector","$parse",function(e,t){return{restrict:"A",scope:!0,compile:function(){return{pre:function(n,i,s){var r=s.injectService;if(r){var c=r.split(",");c.forEach(function(i){var s=i.match(/^\s*(([_a-z0-9$]+).*?)(?:\sas\s(.+))?$/i);if(!s)throw new Error('Unsupported inject-service syntax "'+i+'"');var r=s[2],c=e.get(r),o=s[1],l={};l[r]=c;var a=t(o)(n,l),u=s[3];t(u?u:r).assign(n,a)})}}}}}}]),t.directive("scopeChild",[function(){return{scope:!0,restrict:"AE"}}]),t.directive("selector",["EventEmitterFactory","$parse",function(e,t){function n(){e.apply(this),this.toggle=function(e){this.isSelected(e)?this.unselect(e):this.select(e)}}function i(){n.apply(this),this.type="single",this.selected=void 0,this.reset=function(e){this.selected=e},this.isSelected=function(e){return this.selected===e},this.select=function(e){this.isSelected(e)||(this.selected=e,this.emit("change",this.selected))},this.unselect=function(e){this.isSelected(e)&&(this.selected=void 0,this.emit("change",this.selected))}}function s(){n.apply(this),this.type="list",this.selected=[],this.reset=function(e){this.selected=c(e)?e:e?[e]:[]},this.isSelected=function(e){return-1!==this.selected.indexOf(e)},this.select=function(e){this.isSelected(e)||(this.selected.push(e),this.emit("change",this.selected))},this.unselect=function(e){this.isSelected(e)&&(this.selected.splice(this.selected.indexOf(e),1),this.emit("change",this.selected))}}function r(){n.apply(this),this.type="map",this.selected={},this.reset=function(e){this.selected=o(e)?e:e?Object(e):{}},this.isSelected=function(e){return this.selected.hasOwnProperty(e)&&this.selected[e]},this.select=function(e,t){this.isSelected(e)||(this.selected[e]="undefined"==typeof t?!0:t,this.emit("change",this.selected))},this.unselect=function(e){this.isSelected(e)&&(delete this.selected[e],this.emit("change",this.selected))},this.toggle=function(e,t){this.isSelected(e)?this.unselect(e):this.select(e,t)}}function c(e){return Array.isArray(e)}function o(e){return null!=e&&"object"==typeof e}return{restrict:"A",require:"selector",controller:["$scope","$attrs",function(e,t){switch(t.selectorType){case"list":s.apply(this);break;case"map":r.apply(this);break;default:i.apply(this)}}],compile:function(){return{pre:function(e,n,i,s){function r(e){s.reset(e),s.emit("change",s.selected)}var c;switch(i.selectorType){case"list":c=e.$watchCollection(i.selector,r);break;case"map":c=e.$watch(i.selector,r,!0);break;default:c=e.$watch(i.selector,r)}var o=t(i.selector).assign,l=s.on("change",function(t){o(e,t)});e.$on("$destroy",function(){c(),l()})}}}}}]),t.directive("selectorOption",["$animate",function(e){return{restrict:"A",require:["selectorOption","^selector"],controller:["$scope","$element","$attrs","EventEmitterFactory",function(e,t,n,i){var s=t.controller("selector");i.apply(this),["select","unselect","toggle"].forEach(function(e){this[e]=function(){s[e].apply(s,this.getValue())}}.bind(this)),this.selected=!1,this.getValue=function(){var t=n.selectorOption.match(/^(.+)\sas\s(.+)$/i);return t?[e.$eval(t[1]),e.$eval(t[2])]:[e.$eval(n.selectorOption)]},this.refresh=function(){var e=s.isSelected(this.getValue()[0]);e!=this.selected&&this.emit("change",this.selected=e)};var r=s.on("change",this.refresh.bind(this));e.$on("$destroy",r)}],link:function(t,n,i,s){function r(){return i.selectorOptionDisabled&&t.$eval(i.selectorOptionDisabled)}var c=s[0],o=s[1];i.selectorOptionBind||n.on("click",function(){r()||t.$apply(function(){var e="single"!=o.type;i.selectorOptionToggle&&(e=t.$eval(i.selectorOptionToggle)),c[e?"toggle":"select"]()})});var l=c.on("change",function(t){e[t?"addClass":"removeClass"](n,"ng-selected")});t.$on("$destroy",l),o.isSelected(c.getValue()[0])&&c.refresh()}}}]),t.directive("selectorOptionBind",["$parse",function(e){return{restrict:"A",require:"selectorOption",link:function(t,n,i,s){t.$watch(i.selectorOptionBind,function(e){s[e?"select":"unselect"]()});var r=e(i.selectorOptionBind),c=r.assign,o=s.on("change",function(e){var n=r(t);(n&&!e||!n&&e)&&c(t,e)});t.$on("$destroy",o)}}}]),t.directive("shift",["$animate",function(e){return{restrict:"AE",priority:400,terminal:!0,transclude:"element",link:function(t,n,i,s,r){function c(){l(a),a=o()}function o(){var i={};return i.scope=t.$new(),r(i.scope,function(t){i.element=t,i.element.addClass("ng-shift ng-shift-enter"),e.enter(t,n.parent(),n)}),i}function l(t){t.element&&(t.element.removeClass("ng-shift-enter"),t.element.addClass("ng-shift-leave"),e.leave(t.element),delete t.element),t.scope&&(t.scope.$destroy(),delete t.scope)}var a=o();t.$watch(i.shift||i.value,function(e,t){e!==t&&c()})}}}]),t.factory("EventEmitterFactory",[function(){return function(e){return e=e||(this!==window?this:{}),e.listeners={},e.emit=function(t,n){var i,s,r=Array.prototype.slice.call(arguments,1);if(this.listeners[t])for(i=this.listeners[t].slice(),s=0;s<i.length;s++)i[s].apply(e,r)},e.on=function(e,t){var n,i,s=this;return n=e.split(/\s+/).filter(function(e){return e}),n.length>1?(i=n.map(function(e){return s.on(e,t)}),function(){i.forEach(function(e){e()})}):(e=n[0],this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t),function(){s.off(e,t)})},e.off=function(e,t){var n,i,s=this;if(n=e.split(/\s+/).filter(function(e){return e}),n.length>1)return void n.forEach(function(e){s.off(e,t)});if(e=n[0],this.listeners[e])for(i=0;i<this.listeners[e].length;)this.listeners[e][i]===t?this.listeners[e].splice(i,1):i++},e.once=function(e,t){var n=this.on(e,function(){t.apply(this,arguments),n()});return n},e}}]),t.filter("length",function(){return function(e){return e instanceof Array?e.length:e?e instanceof String?e.length:Object.keys(e).length:0}}),t.factory("ensureDigest",["$rootScope",function(e){var t;return t=function(t){var n,i=!1;t&&"function"==typeof t?n=t:t&&(i=!0),n?e.$$phase?n():e.$apply(n):e.$$phase||(i?e.$evalAsync():e.$digest())}}]),t.factory("localStorage",["$window",function(e){try{return e.localStorage||{}}catch(t){return{}}}]),t.factory("localStorageStore",["localStorage",function(t){return{get:function(n){var i=t[n];return i?e.fromJson(i):i},put:function(n,i){t[n]=e.toJson(i)},remove:function(e){delete t[e]}}}]),t.factory("sessionStorage",["$window",function(e){try{return e.sessionStorage||{}}catch(t){return{}}}]),t.factory("sessionStorageStore",["sessionStorage",function(e){return{get:function(t){var n=e[t];try{return n?JSON.parse(n):n}catch(i){return void 0}},put:function(t,n){e[t]=JSON.stringify(n)},remove:function(t){delete e[t]}}}])}(angular);